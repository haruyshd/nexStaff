<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>NexStaff Admin Dashboard</title>
    <link rel="icon" href="../client/img/logo.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet"><!-- Include Data Service -->
    <script src="../client/js/dataManager.js"></script>
    <script src="js/dataService.js"></script>
    <script src="js/jobManagement.js"></script>
      <style>
        :root {
            /* Modern Color Palette */
            --primary: #8B5CF6;
            --primary-dark: #7C3AED;
            --primary-light: #F3E8FF;
            --primary-gradient: linear-gradient(135deg, #8B5CF6 0%, #3B82F6 50%, #06B6D4 100%);
            --secondary: #64748B;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --info: #3B82F6;
            --dark: #0F172A;
            --light: #F8FAFC;
            --white: #FFFFFF;
            --border: #E2E8F0;
            --border-light: #F1F5F9;
            --text-primary: #0F172A;
            --text-secondary: #64748B;
            --text-muted: #94A3B8;
            --sidebar-width: 320px;
            --header-height: 80px;
            
            /* Modern Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            
            /* Modern Border Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --radius-2xl: 24px;
            
            /* Modern Transitions */
            --transition-fast: 0.15s ease-out;
            --transition-normal: 0.25s ease-out;
            --transition-slow: 0.35s ease-out;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 100%);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 14px;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Layout */
        .admin-layout {
            display: flex;
            min-height: 100vh;
            background: linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 100%);
        }        /* Modern Sidebar with Glass Morphism */
        .sidebar {
            width: var(--sidebar-width);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: var(--shadow-2xl);
            position: fixed;
            height: 100vh;
            z-index: 1000;
            transition: all var(--transition-normal);
            overflow-y: auto;
            overflow-x: hidden;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(139, 92, 246, 0.3);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(139, 92, 246, 0.5);
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(139, 92, 246, 0.05);
            position: relative;
            overflow: hidden;
        }

        .sidebar-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary-gradient);
            opacity: 0.1;
            z-index: -1;
        }

        .logo {
            width: 48px;
            height: 48px;
            object-fit: contain;
            border-radius: var(--radius-md);
            padding: 8px;
            background: var(--white);
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
        }

        .logo:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
        }

        .brand-text {
            font-size: 1.75rem;
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.025em;
        }

        .nav-menu {
            padding: 1.5rem 0;
        }        .nav-item {
            margin: 0.5rem 1.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.25rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: all var(--transition-normal);
            font-weight: 500;
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary-gradient);
            opacity: 0;
            transition: all var(--transition-normal);
            z-index: -1;
        }

        .nav-link:hover {
            color: var(--primary);
            background: rgba(139, 92, 246, 0.08);
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
        }

        .nav-link:hover::before {
            opacity: 0.1;
        }

        .nav-link.active {
            color: var(--white);
            background: var(--primary-gradient);
            box-shadow: var(--shadow-lg);
            transform: translateX(4px);
        }

        .nav-link.active::before {
            opacity: 1;
        }

        .nav-link i {
            font-size: 1.1rem;
            width: 20px;
            text-align: center;
            transition: all var(--transition-normal);
        }

        .nav-link:hover i,
        .nav-link.active i {
            transform: scale(1.1);
        }

        .nav-link span {
            font-weight: 600;
            letter-spacing: -0.01em;
        }

        .nav-link:hover {
            background: var(--primary-light);
            color: var(--primary);
        }

        .nav-link.active {
            background: var(--primary);
            color: var(--white);
        }

        .nav-link i {
            width: 20px;
            font-size: 1.1rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: margin-left 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        /* Header */
        .header {
            background: var(--white);
            height: var(--header-height);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }

        .menu-toggle:hover {
            background: var(--light);
            color: var(--primary);
        }

        .page-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .notification-badge {
            position: absolute;
            top: 0.25rem;
            right: 0.25rem;
            background: var(--danger);
            color: white;
            font-size: 0.75rem;
            padding: 0.125rem 0.375rem;
            border-radius: 1rem;
            min-width: 1.25rem;
            text-align: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text-primary);
        }

        .user-role {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Content Area */
        .content {
            padding: 2rem;
            min-height: calc(100vh - var(--header-height));
        }

        .section {
            display: none;
        }        .section.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Section titles */
        .section-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }

        /* Form controls improvements */
        .form-control-sm {
            font-size: 0.875rem;
        }

        .d-flex.gap-2 > * {
            margin-right: 0.5rem;
        }

        .d-flex.gap-2 > *:last-child {
            margin-right: 0;
        }

        /* Cards */
        .card {
            background: var(--white);
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: between;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .card-body {
            padding: 1.5rem;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--primary);
        }

        .stat-card.success {
            border-left-color: var(--success);
        }

        .stat-card.warning {
            border-left-color: var(--warning);
        }

        .stat-card.danger {
            border-left-color: var(--danger);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .stat-title {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-icon {
            width: 3rem;
            height: 3rem;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-icon.primary { background: var(--primary); }
        .stat-icon.success { background: var(--success); }
        .stat-icon.warning { background: var(--warning); }
        .stat-icon.danger { background: var(--danger); }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }        /* Tables */
        .table-container {
            overflow-x: auto;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 0;
        }

        .table th,
        .table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
            vertical-align: middle;
        }

        .table th {
            background: var(--light);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-top: none;
        }

        .table tr:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        /* Fix Bootstrap table conflicts */
        .table-responsive {
            border: none;
            box-shadow: none;
        }

        .table-responsive .table {
            margin-bottom: 0;
        }

        /* Jobs table specific styling */
        #jobs-section .table td {
            font-size: 0.875rem;
        }

        #jobs-section .badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }        #jobs-section .btn-group .btn {
            padding: 0.375rem 0.5rem;
            font-size: 0.75rem;
        }

        #jobs-section .status-select {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
        }

        /* Responsive table improvements */
        @media (max-width: 768px) {
            .table-responsive {
                border: none;
            }
            
            #jobs-section .table th,
            #jobs-section .table td {
                padding: 0.5rem;
                font-size: 0.8rem;
            }
            
            #jobs-section .btn-group .btn {
                padding: 0.25rem 0.375rem;
                font-size: 0.7rem;
            }
        }

        /* Loading state improvements */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            text-align: center;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* Status Badges */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 500;
            border-radius: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .badge-primary {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .menu-toggle {
                display: block;
            }

            .content {
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .header {
                padding: 0 1rem;
            }
        }

        /* Section Management */
        .section {
            display: none;
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .section.active {
            display: block;
            opacity: 1;
        }
        
        .section-content {
            padding: 0;
        }
        
        /* Chart Container Styling */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            padding: 1rem;
        }
        
        .chart-container canvas {
            width: 100% !important;
            height: 100% !important;
        }

        /* Overlay for mobile */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .spinner {
            border: 2px solid var(--border);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            width: 1.5rem;
            height: 1.5rem;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Charts Container */
        .chart-container {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light);
            border-radius: 0.5rem;
            color: var(--text-secondary);
        }

        /* Employee Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .close:hover {
            background: var(--light);
            color: var(--primary);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .form-group input,
        .form-group select {
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--white);
            border-radius: 8px;
            padding: 1rem 1.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 3000;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
            max-width: 400px;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification-success {
            border-left: 4px solid var(--success);
        }

        .notification-success i {
            color: var(--success);
        }

        .notification-error {
            border-left: 4px solid var(--danger);
        }

        .notification-error i {
            color: var(--danger);
        }

        .notification-info {
            border-left: 4px solid var(--info);
        }

        .notification-info i {
            color: var(--info);
        }

        .notification-warning {
            border-left: 4px solid var(--warning);
        }

        .notification-warning i {
            color: var(--warning);
        }        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.show {
            display: flex !important;
        }

        .hire-modal-overlay {
            display: flex !important;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(8px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            padding: 2rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: var(--light);
            color: var(--primary);
        }

        .modal-body {
            margin-bottom: 1.5rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Additional styles for CRUD modals */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }
        
        .status-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
        }
          .status-active, .status-open, .status-scheduled { background: #d4edda; color: #155724; }
        .status-inactive, .status-closed, .status-cancelled { background: #f8d7da; color: #721c24; }
        .status-pending, .status-reviewing, .status-on { background: #fff3cd; color: #856404; }
        .status-hired, .status-completed, .status-filled { background: #d1ecf1; color: #0c5460; }

        /* Candidate Approval System Styles */
        .candidate-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid var(--border);
            background: var(--white);
            color: var(--text-secondary);
            border-radius: 12px;
            cursor: pointer;
            transition: all var(--transition-fast);
            font-weight: 500;
            font-size: 0.95rem;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2);
        }

        .filter-btn.active {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        #candidateCards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .profile-card {
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border);
            transition: all var(--transition-normal);
        }

        .profile-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.15);
        }

        .profile-card.pending {
            border-left: 4px solid var(--warning);
        }

        .profile-card.approved {
            border-left: 4px solid var(--success);
        }

        .profile-card.rejected {
            border-left: 4px solid var(--danger);
            opacity: 0.8;
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .profile-header h3 {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .approval-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .approval-badge.pending {
            background: rgba(245, 158, 11, 0.1);
            color: #D97706;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .approval-badge.approved {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .approval-badge.rejected {
            background: rgba(239, 68, 68, 0.1);
            color: #DC2626;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .profile-content {
            margin-bottom: 1.5rem;
        }

        .profile-content p {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .profile-content strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .skills {
            margin: 1rem 0;
        }

        .skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag {
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary);
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .applied-jobs {
            margin: 1rem 0;
        }

        .applied-jobs ul {
            list-style: none;
            padding: 0;
            margin-top: 0.5rem;
        }

        .applied-jobs li {
            padding: 0.3rem 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .profile-actions {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .profile-actions .btn {
            flex: 1;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all var(--transition-fast);
            border: none;
            cursor: pointer;
            text-decoration: none;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .btn.btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn.btn-success:hover {
            background: #059669;
        }

        .btn.btn-danger {
            background: var(--danger);
            color: var(--white);
        }

        .btn.btn-danger:hover {
            background: #DC2626;
        }

        .btn.btn-warning {
            background: var(--warning);
            color: var(--white);
        }        .btn.btn-warning:hover {
            background: #D97706;
        }

        .btn.btn-secondary {
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary);
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        /* Enhanced styling for approve/reject buttons */
        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
            line-height: 1.5;
            border-radius: 0.375rem;
            margin: 0 2px;
            min-width: 36px;
            transition: all var(--transition-fast);
        }

        .btn-sm:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        /* Specific styling for approve button */
        .btn-sm.btn-success {
            background: linear-gradient(135deg, var(--success), #059669);
            border: none;
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
        }

        .btn-sm.btn-success:hover {
            background: linear-gradient(135deg, #059669, #047857);
            box-shadow: 0 4px 8px rgba(16, 185, 129, 0.4);
        }

        /* Specific styling for reject button */
        .btn-sm.btn-warning {
            background: linear-gradient(135deg, var(--warning), #D97706);
            border: none;
            box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
        }

        .btn-sm.btn-warning:hover {
            background: linear-gradient(135deg, #D97706, #B45309);
            box-shadow: 0 4px 8px rgba(245, 158, 11, 0.4);
        }        /* Action buttons container */
        .action-buttons {
            display: flex;
            gap: 4px;
            align-items: center;
            flex-wrap: wrap;
        }

        .action-buttons .btn-sm {
            margin: 1px;
        }

        /* Enhanced notification styles */
        .admin-notification {
            border-radius: var(--radius-md);
            border: none;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .admin-notification.alert-success {
            background: rgba(16, 185, 129, 0.95);
            color: white;
        }

        .admin-notification.alert-danger {
            background: rgba(239, 68, 68, 0.95);
            color: white;
        }

        .admin-notification.alert-warning {
            background: rgba(245, 158, 11, 0.95);
            color: white;
        }

        .admin-notification.alert-info {
            background: rgba(59, 130, 246, 0.95);
            color: white;
        }

        .admin-notification .close {
            color: inherit;
            opacity: 0.8;
        }

        .admin-notification .close:hover {
            opacity: 1;
        }

        /* Badge improvements */
        .badge {
            font-size: 0.75rem;
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius-sm);
            font-weight: 500;
        }

        .badge-info {
            background: linear-gradient(135deg, var(--info), #2563EB);
            color: white;
        }

        .badge-success {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
        }

        .badge-warning {
            background: linear-gradient(135deg, var(--warning), #D97706);
            color: white;
        }

        .badge-danger {
            background: linear-gradient(135deg, var(--danger), #DC2626);
            color: white;
        }

        .btn.btn-secondary:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        /* Notification Styles */
        .notification {
            background: var(--white);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--info);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            min-width: 300px;
            max-width: 400px;
            animation: slideInRight 0.3s ease-out;
            margin-bottom: 0.5rem;
        }

        .notification.success {
            border-left-color: var(--success);
            color: #059669;
        }

        .notification.warning {
            border-left-color: var(--warning);
            color: #D97706;
        }

        .notification.error {
            border-left-color: var(--danger);
            color: #DC2626;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Candidate Detail Modal */
        .candidate-detail-modal {
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .candidate-detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .detail-section {
            background: #F8FAFC;
            border-radius: 12px;
            padding: 1.5rem;
        }

        .detail-section h4 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-weight: 600;
            border-bottom: 2px solid rgba(139, 92, 246, 0.1);
            padding-bottom: 0.5rem;
        }

        .detail-section .status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: capitalize;
        }

        .detail-section .status.pending {
            background: rgba(245, 158, 11, 0.1);
            color: #D97706;
        }

        .detail-section .status.approved {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
        }

        .detail-section .status.rejected {
            background: rgba(239, 68, 68, 0.1);
            color: #DC2626;
        }        /* Responsive Design */
        @media (max-width: 768px) {
            #candidateCards {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .candidate-filters {
                flex-direction: column;
                align-items: center;
            }
            
            .profile-actions {
                flex-direction: column;
            }
            
            .profile-actions .btn {
                min-width: auto;
            }
        }        /* Section Content Wrapper */
        .section-content {
            padding: 1rem;
        }

        /* Override any conflicting table styles for candidate profiles */
        #candidateProfiles .table {
            display: none;
        }

        /* Ensure candidate profiles display properly */
        #candidateProfiles {
            width: 100%;
            max-width: none;
        }        /* Fix any potential z-index issues */
        .candidate-modal-overlay {
            z-index: 10000;
        }

        /* Candidate Form Modal Styles */
        .candidate-form-modal {
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .form-group input,
        .form-group select {
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.2s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        /* Button styles for forms */
        .btn.btn-info {
            background: var(--info);
            color: var(--white);
        }

        .btn.btn-info:hover {
            background: #2563EB;
        }

        /* Responsive form */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-footer {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="admin-layout">
        <!-- Overlay for mobile -->
        <div class="overlay" id="overlay"></div>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">            <div class="sidebar-header">
                <img src="../../client/img/logo.png" alt="NexStaff" class="logo">
                <span class="brand-text">NexStaff</span>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-item">
                    <a href="#" class="nav-link active" data-section="dashboard">
                        <i class="fas fa-th-large"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="employees">
                        <i class="fas fa-users"></i>
                        <span>Employees</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="candidates">
                        <i class="fas fa-user-tie"></i>
                        <span>Candidates</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="employers">
                        <i class="fas fa-building"></i>
                        <span>Employers</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="schedule">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Schedule</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="applications">
                        <i class="fas fa-file-alt"></i>
                        <span>Applications</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="jobs">
                        <i class="fas fa-briefcase"></i>
                        <span>Jobs</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </div>
                <div class="nav-item" style="margin-top: 2rem;">
                    <a href="#" class="nav-link" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </a>
                </div>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title" id="pageTitle">Dashboard</h1>                </div>
                
                <div class="header-right">
                    <!-- Notification and user menu removed -->
                </div>
            </header>

            <!-- Content Area -->
            <main class="content">
                <!-- Dashboard Section -->
                <section id="dashboard-section" class="section active">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-title">Total Employees</div>
                                <div class="stat-icon primary">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                            <div class="stat-value">1,247</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+12% from last month</span>
                            </div>
                        </div>

                        <div class="stat-card success">
                            <div class="stat-header">
                                <div class="stat-title">Active Candidates</div>
                                <div class="stat-icon success">
                                    <i class="fas fa-user-tie"></i>
                                </div>
                            </div>
                            <div class="stat-value">3,856</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+8% from last month</span>
                            </div>
                        </div>

                        <div class="stat-card warning">
                            <div class="stat-header">
                                <div class="stat-title">Open Positions</div>
                                <div class="stat-icon warning">
                                    <i class="fas fa-briefcase"></i>
                                </div>
                            </div>
                            <div class="stat-value">124</div>
                            <div class="stat-change negative">
                                <i class="fas fa-arrow-down"></i>
                                <span>-3% from last month</span>
                            </div>
                        </div>

                        <div class="stat-card danger">
                            <div class="stat-header">
                                <div class="stat-title">Pending Applications</div>
                                <div class="stat-icon danger">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                            </div>
                            <div class="stat-value">89</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+15% from last month</span>
                            </div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Recent Activities</h3>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="activityChart" width="400" height="200"></canvas>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Quick Actions</h3>
                            </div>
                            <div class="card-body" style="display: flex; flex-direction: column; gap: 1rem;">
                                <button class="btn btn-primary" id="addEmployeeBtn" onclick="handleQuickAction('employees', 'addEmployee');">
                                    <i class="fas fa-plus"></i>
                                    Add New Employee
                                </button>
                                <button class="btn btn-success" id="registerCandidateBtn" onclick="handleQuickAction('candidates', 'registerCandidate');">
                                    <i class="fas fa-user-plus"></i>
                                    Register Candidate
                                </button>
                                <button class="btn btn-warning" id="postJobBtn" onclick="handleQuickAction('jobs', 'postJob');">
                                    <i class="fas fa-briefcase"></i>
                                    Post New Job
                                </button>
                                <button class="btn btn-secondary" id="scheduleInterviewBtn" onclick="handleQuickAction('schedule', 'scheduleInterview');">
                                    <i class="fas fa-calendar-plus"></i>
                                    Schedule Interview
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Recent Hires</h3>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Position</th>
                                            <th>Department</th>
                                            <th>Start Date</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>John Smith</td>
                                            <td>Software Engineer</td>
                                            <td>Technology</td>
                                            <td>2025-06-01</td>
                                            <td><span class="badge badge-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td>Sarah Johnson</td>
                                            <td>Marketing Manager</td>
                                            <td>Marketing</td>
                                            <td>2025-05-28</td>
                                            <td><span class="badge badge-success">Active</span></td>
                                        </tr>
                                        <tr>
                                            <td>Mike Chen</td>
                                            <td>Data Analyst</td>
                                            <td>Analytics</td>
                                            <td>2025-05-25</td>
                                            <td><span class="badge badge-warning">Training</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Employees Section -->
                <section id="employees-section" class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 600;">Employee Management</h2>
                        <button class="btn btn-primary" id="employeeSectionAddBtn">
                            <i class="fas fa-plus"></i>
                            Add Employee
                        </button>
                    </div>

                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 class="card-title">All Employees</h3>
                            <div style="display: flex; gap: 1rem;">
                                <input type="search" class="form-control" placeholder="Search employees..." style="width: 250px;">
                                <select class="form-control" style="width: 150px;">
                                    <option>All Departments</option>
                                    <option>Technology</option>
                                    <option>Marketing</option>
                                    <option>Sales</option>
                                    <option>HR</option>
                                </select>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Employee ID</th>
                                            <th>Name</th>
                                            <th>Email</th>
                                            <th>Department</th>
                                            <th>Position</th>
                                            <th>Hire Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="employeesTableBody">
                                        <tr>
                                            <td>EMP001</td>
                                            <td>John Smith</td>
                                            <td>john.smith@nexstaff.com</td>
                                            <td>Technology</td>
                                            <td>Software Engineer</td>
                                            <td>2024-01-15</td>
                                            <td><span class="badge badge-success">Active</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="btn btn-sm btn-primary">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-sm btn-danger">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>EMP002</td>
                                            <td>Sarah Johnson</td>
                                            <td>sarah.johnson@nexstaff.com</td>
                                            <td>Marketing</td>
                                            <td>Marketing Manager</td>
                                            <td>2024-02-20</td>
                                            <td><span class="badge badge-success">Active</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="btn btn-sm btn-primary">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-sm btn-danger">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Continue with other sections... -->                <section id="candidates-section" class="section">
                    <div class="section-content">                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <h2 style="font-size: 1.5rem; font-weight: 600;">Candidate Management</h2>
                            <div style="display: flex; gap: 1rem;">
                                <button class="btn btn-success" onclick="CandidateProfilesAPI.createCandidate()">
                                    <i class="fas fa-user-plus"></i>
                                    Add Candidate
                                </button>
                                <button class="btn btn-primary" onclick="CandidateProfilesAPI.loadCandidateProfiles()">
                                    <i class="fas fa-sync-alt"></i>
                                    Refresh
                                </button>
                                <button class="btn btn-secondary" onclick="CandidateProfilesAPI.test()">
                                    <i class="fas fa-flask"></i>
                                    Test API
                                </button>
                                <button class="btn btn-info" onclick="CandidateProfilesAPI.testCreate()">
                                    <i class="fas fa-bug"></i>
                                    Test Create
                                </button>
                            </div>
                        </div>

                        <!-- Candidate Profiles Container -->
                        <div id="candidateProfiles">
                            <div class="text-center" style="padding: 2rem;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #8B5CF6;"></i>
                                <p style="margin-top: 1rem;">Loading candidates...</p>
                            </div>
                        </div>
                    </div>
                </section><section id="employers-section" class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 600;">Employer Management</h2>
                        <button class="btn btn-primary" id="addEmployerBtn">
                            <i class="fas fa-building"></i>
                            Add Employer
                        </button>
                    </div>

                    <div class="card">                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 class="card-title">All Employers</h3>
                            <div style="display: flex; gap: 1rem;">
                                <input type="search" class="form-control" id="employerSearch" placeholder="Search employers..." style="width: 250px;">
                                <select class="form-control" id="industryFilter" style="width: 150px;">
                                    <option value="">All Industries</option>
                                    <option value="Technology">Technology</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Finance">Finance</option>
                                    <option value="Manufacturing">Manufacturing</option>
                                    <option value="Education">Education</option>
                                    <option value="Retail">Retail</option>
                                </select>
                                <select class="form-control" id="statusFilter" style="width: 120px;">
                                    <option value="">All Status</option>
                                    <option value="Pending">Pending</option>
                                    <option value="Active">Active</option>
                                    <option value="Rejected">Rejected</option>
                                </select>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Employer ID</th>
                                            <th>Company</th>
                                            <th>Contact Person</th>
                                            <th>Email</th>
                                            <th>Phone</th>
                                            <th>Industry</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="employersTableBody">
                                        <tr>
                                            <td colspan="8" class="text-center">Loading employers...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="schedule-section" class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 600;">Schedule Management</h2>
                        <button class="btn btn-primary" id="addScheduleBtn">
                            <i class="fas fa-calendar-plus"></i>
                            New Event
                        </button>
                    </div>

                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 class="card-title">All Scheduled Events</h3>
                            <div style="display: flex; gap: 1rem;">
                                <input type="search" class="form-control" placeholder="Search events..." style="width: 250px;">
                                <select class="form-control" style="width: 150px;">
                                    <option>All Types</option>
                                    <option>Interview</option>
                                    <option>Meeting</option>
                                    <option>Training</option>
                                    <option>Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Event ID</th>
                                            <th>Title</th>
                                            <th>Date</th>
                                            <th>Time</th>
                                            <th>Type</th>
                                            <th>Participants</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="schedulesTableBody">
                                        <tr>
                                            <td colspan="8" class="text-center">Loading events...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>                </section>

                <section id="applications-section" class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 600;">Application Management</h2>                        <button class="btn btn-primary" id="addApplicationBtn" onclick="crudManager.openCreateModal('application')">
                            <i class="fas fa-file-plus"></i>
                            New Application
                        </button>
                    </div>

                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 class="card-title">All Applications</h3>
                            <div style="display: flex; gap: 1rem;">
                                <input type="search" id="applicationsSearchInput" class="form-control" placeholder="Search applications..." style="width: 250px;">
                                <select id="applicationsStatusFilter" class="form-control" style="width: 150px;">
                                    <option>All Status</option>
                                    <option>Pending</option>
                                    <option>Under Review</option>
                                    <option>Interview</option>
                                    <option>Accepted</option>
                                    <option>Rejected</option>
                                </select>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="thead-light">
                                        <tr>
                                            <th><input type="checkbox" id="selectAllApplications"></th>
                                            <th style="min-width: 200px;">Candidate</th>
                                            <th style="min-width: 150px;">Position</th>
                                            <th style="min-width: 120px;">Status</th>
                                            <th style="min-width: 120px;">Applied Date</th>
                                            <th style="min-width: 120px;">Last Updated</th>
                                            <th style="min-width: 200px;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="applicationsTableBody">
                                        <tr>
                                            <td colspan="7" class="text-center py-4">
                                                <div class="spinner-border text-primary" role="status">
                                                    <span class="sr-only">Loading...</span>
                                                </div>
                                                <div class="mt-2">Loading applications...</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="jobs-section" class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 600;">Job Management</h2>                        <button class="btn btn-primary" id="addJobBtn" onclick="JobManagementAPI.openJobModal()">
                            <i class="fas fa-briefcase"></i>
                            Post Job
                        </button>
                    </div>

                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 class="card-title">All Job Postings</h3>                            <div style="display: flex; gap: 1rem;">
                                <input type="search" id="jobsSearchInput" class="form-control" placeholder="Search jobs..." style="width: 250px;">
                                <select id="jobsTypeFilter" class="form-control" style="width: 150px;">
                                    <option>All Types</option>
                                    <option>Full-time</option>
                                    <option>Part-time</option>
                                    <option>Contract</option>
                                    <option>Internship</option>
                                </select>
                            </div>
                        </div>                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="thead-light">
                                        <tr>
                                            <th style="min-width: 100px;">Job ID</th>
                                            <th style="min-width: 200px;">Title</th>
                                            <th style="min-width: 150px;">Company</th>
                                            <th style="min-width: 150px;">Location</th>
                                            <th style="min-width: 120px;">Type</th>
                                            <th style="min-width: 150px;">Salary</th>
                                            <th style="min-width: 120px;">Status</th>
                                            <th style="min-width: 120px;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="jobsTableBody">
                                        <tr>
                                            <td colspan="8" class="text-center py-4">
                                                <div class="spinner-border text-primary" role="status">
                                                    <span class="sr-only">Loading...</span>
                                                </div>
                                                <div class="mt-2">Loading jobs...</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="settings-section" class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 600;">System Settings</h2>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">General Settings</h3>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Company Name</label>
                                    <input type="text" class="form-control" value="NexStaff">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Company Email</label>
                                    <input type="email" class="form-control" value="admin@nexstaff.com">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Time Zone</label>
                                    <select class="form-control">
                                        <option>UTC-8 (Pacific Time)</option>
                                        <option>UTC-5 (Eastern Time)</option>
                                        <option>UTC+0 (GMT)</option>
                                    </select>
                                </div>
                                <button class="btn btn-primary">Save Changes</button>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Security Settings</h3>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Current Password</label>
                                    <input type="password" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">New Password</label>
                                    <input type="password" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Confirm Password</label>
                                    <input type="password" class="form-control">
                                </div>
                                <button class="btn btn-warning">Update Password</button>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>    <!-- CRUD Modals for All Entities -->
    
    <!-- Employees Modal -->
    <div class="modal-overlay" id="employeesModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="employeesModalTitle">Add Employee</h3>
                <button type="button" class="close-btn" onclick="crudManagers.employees.closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="employeesForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="employeeId">Employee ID</label>
                            <input type="text" id="employeeId" name="employeeId" required>
                        </div>
                        <div class="form-group">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone</label>
                            <input type="tel" id="phone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="department">Department</label>
                            <select id="department" name="department" required>
                                <option value="">Select Department</option>
                                <option value="Technology">Technology</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Sales">Sales</option>
                                <option value="HR">HR</option>
                                <option value="Finance">Finance</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="position">Position</label>
                            <input type="text" id="position" name="position" required>
                        </div>
                        <div class="form-group">
                            <label for="hireDate">Hire Date</label>
                            <input type="date" id="hireDate" name="hireDate" required>
                        </div>
                        <div class="form-group">
                            <label for="salary">Salary</label>
                            <input type="number" id="salary" name="salary" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="status">Status</label>
                            <select id="status" name="status" required>
                                <option value="">Select Status</option>
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                                <option value="On Leave">On Leave</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="crudManagers.employees.closeModal()">Cancel</button>
                <button type="submit" form="employeesForm" class="btn btn-primary">Save Employee</button>
            </div>
        </div>
    </div>

    <!-- Candidates Modal -->
    <div class="modal-overlay" id="candidatesModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="candidatesModalTitle">Add Candidate</h3>
                <button type="button" class="close-btn" onclick="crudManagers.candidates.closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="candidatesForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="candidateName">Full Name</label>
                            <input type="text" id="candidateName" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="candidateEmail">Email</label>
                            <input type="email" id="candidateEmail" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="candidatePhone">Phone</label>
                            <input type="tel" id="candidatePhone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="experience">Years of Experience</label>
                            <input type="number" id="experience" name="experience" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="education">Education</label>
                            <input type="text" id="education" name="education" required>
                        </div>
                        <div class="form-group">
                            <label for="resume">Resume URL</label>
                            <input type="url" id="resume" name="resume">
                        </div>
                        <div class="form-group full-width">
                            <label for="skills">Skills</label>
                            <textarea id="skills" name="skills" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="candidateStatus">Status</label>
                            <select id="candidateStatus" name="status" required>
                                <option value="">Select Status</option>
                                <option value="New">New</option>
                                <option value="Reviewing">Reviewing</option>
                                <option value="Shortlisted">Shortlisted</option>
                                <option value="Interviewed">Interviewed</option>
                                <option value="Hired">Hired</option>
                                <option value="Rejected">Rejected</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="crudManagers.candidates.closeModal()">Cancel</button>
                <button type="submit" form="candidatesForm" class="btn btn-primary">Save Candidate</button>
            </div>
        </div>
    </div>

    <!-- Employers Modal -->
    <div class="modal-overlay" id="employersModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="employersModalTitle">Add Employer</h3>
                <button type="button" class="close-btn" onclick="crudManagers.employers.closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="employersForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="companyName">Company Name</label>
                            <input type="text" id="companyName" name="companyName" required>
                        </div>
                        <div class="form-group">
                            <label for="contactName">Contact Person</label>
                            <input type="text" id="contactName" name="contactName" required>
                        </div>
                        <div class="form-group">
                            <label for="employerEmail">Email</label>
                            <input type="email" id="employerEmail" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="employerPhone">Phone</label>
                            <input type="tel" id="employerPhone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="industry">Industry</label>
                            <input type="text" id="industry" name="industry" required>
                        </div>
                        <div class="form-group">
                            <label for="website">Website</label>
                            <input type="url" id="website" name="website">
                        </div>
                        <div class="form-group full-width">
                            <label for="address">Address</label>
                            <textarea id="address" name="address" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="employerStatus">Status</label>
                            <select id="employerStatus" name="status" required>
                                <option value="">Select Status</option>
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="crudManagers.employers.closeModal()">Cancel</button>
                <button type="submit" form="employersForm" class="btn btn-primary">Save Employer</button>
            </div>
        </div>
    </div>

    <!-- Applications Modal -->
    <div class="modal-overlay" id="applicationsModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="applicationsModalTitle">Add Application</h3>
                <button type="button" class="close-btn" onclick="crudManagers.applications.closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="applicationsForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="candidateName">Candidate Name</label>
                            <input type="text" id="candidateName" name="candidateName" required>
                        </div>                        <div class="form-group">
                            <label for="applicationCandidateEmail">Candidate Email</label>
                            <input type="email" id="applicationCandidateEmail" name="candidateEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="jobTitle">Job Title</label>
                            <input type="text" id="jobTitle" name="jobTitle" required>
                        </div>                        <div class="form-group">
                            <label for="applicationCompanyName">Company</label>
                            <input type="text" id="applicationCompanyName" name="companyName" required>
                        </div>
                        <div class="form-group full-width">
                            <label for="coverLetter">Cover Letter</label>
                            <textarea id="coverLetter" name="coverLetter" rows="4"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="applicationStatus">Status</label>
                            <select id="applicationStatus" name="status" required>
                                <option value="">Select Status</option>
                                <option value="Pending">Pending</option>
                                <option value="Reviewing">Reviewing</option>
                                <option value="Shortlisted">Shortlisted</option>
                                <option value="Interviewed">Interviewed</option>
                                <option value="Offered">Offered</option>
                                <option value="Hired">Hired</option>
                                <option value="Rejected">Rejected</option>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label for="notes">Notes</label>
                            <textarea id="notes" name="notes" rows="3"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="crudManagers.applications.closeModal()">Cancel</button>
                <button type="submit" form="applicationsForm" class="btn btn-primary">Save Application</button>
            </div>
        </div>
    </div>    <!-- Jobs Modal -->
    <div class="modal-overlay" id="jobsModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="jobsModalTitle">Add Job</h3>
                <button type="button" class="close-btn" onclick="JobManagementAPI.closeJobModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="jobsForm" onsubmit="JobManagementAPI.saveJobFromModal(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="jobTitle">Job Title</label>
                            <input type="text" id="jobTitle" name="title" required>
                        </div>
                        <div class="form-group">
                            <label for="company">Company</label>
                            <input type="text" id="company" name="company" required>
                        </div>
                        <div class="form-group">
                            <label for="location">Location</label>
                            <input type="text" id="location" name="location" required>
                        </div>
                        <div class="form-group">
                            <label for="jobType">Job Type</label>
                            <select id="jobType" name="type" required>
                                <option value="">Select Type</option>
                                <option value="Full-time">Full-time</option>
                                <option value="Part-time">Part-time</option>
                                <option value="Contract">Contract</option>
                                <option value="Temporary">Temporary</option>
                                <option value="Internship">Internship</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="salaryRange">Salary Range</label>
                            <input type="text" id="salaryRange" name="salary" placeholder="e.g., $60,000 - $80,000">
                        </div>
                        <div class="form-group full-width">
                            <label for="jobDescription">Job Description</label>
                            <textarea id="jobDescription" name="description" rows="4" placeholder="Describe the role, responsibilities, and what you're looking for..."></textarea>
                        </div>
                        <div class="form-group full-width">
                            <label for="jobRequirements">Job Requirements</label>
                            <textarea id="jobRequirements" name="requirements" rows="4" placeholder="List requirements, skills, and qualifications (one per line)..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="applicationDeadline">Application Deadline</label>
                            <input type="date" id="applicationDeadline" name="deadline">
                        </div>
                        <div class="form-group">
                            <label for="jobStatus">Status</label>
                            <select id="jobStatus" name="status">
                                <option value="ACTIVE">Active</option>
                                <option value="DRAFT">Draft</option>
                                <option value="ON HOLD">On Hold</option>
                                <option value="CLOSED">Closed</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="JobManagementAPI.closeJobModal()">Cancel</button>
                <button type="submit" form="jobsForm" class="btn btn-primary">Save Job</button>
            </div>
        </div>
    </div>

    <!-- Entity Modal -->
    <div id="entityModal" class="modal-overlay">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="modalTitle">Add Entity</h3>
                <button type="button" class="close-btn" onclick="crudManager.closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="entityForm">
                    <!-- Form fields will be dynamically generated -->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelEntity">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveEntity">Save</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Delete</h3>
                <button type="button" class="close-btn" onclick="crudManager.closeDeleteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this item? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelDelete">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDelete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Quick Actions Modals -->
    <!-- Note: Employee modal has been consolidated with the main entity modal system -->
    <!-- Modal now handled by the CRUD Manager system -->

    <!-- Post Job Modal -->
    <div id="postJobModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Post New Job</h3>
                <button type="button" class="close-btn" onclick="closePostJobModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="postJobForm">
                    <div class="form-group">
                        <label for="jobTitle">Job Title</label>
                        <input type="text" id="jobTitle" name="jobTitle" required>
                    </div>
                    <div class="form-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="jobDepartment">Department</label>
                            <select id="jobDepartment" name="jobDepartment" required>
                                <option value="">Select Department</option>
                                <option value="Human Resources">Human Resources</option>
                                <option value="Technology">Technology</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Finance">Finance</option>
                                <option value="Operations">Operations</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="jobType">Employment Type</label>
                            <select id="jobType" name="jobType" required>
                                <option value="">Select Type</option>
                                <option value="Full-time">Full-time</option>
                                <option value="Part-time">Part-time</option>
                                <option value="Contract">Contract</option>
                                <option value="Internship">Internship</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="jobLocation">Location</label>
                            <input type="text" id="jobLocation" name="jobLocation" required>
                        </div>
                        <div class="form-group">
                            <label for="jobSalary">Salary Range</label>
                            <input type="text" id="jobSalary" name="jobSalary" placeholder="e.g., $50,000 - $70,000">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="jobDescription">Job Description</label>
                        <textarea id="jobDescription" name="jobDescription" rows="4" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="jobRequirements">Requirements</label>
                        <textarea id="jobRequirements" name="jobRequirements" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closePostJobModal()">Cancel</button>
                <button type="submit" form="postJobForm" class="btn btn-warning">Post Job</button>
            </div>
        </div>
    </div>

    <!-- Schedule Interview Modal -->
    <div id="scheduleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Schedule Interview</h3>
                <button type="button" class="close-btn" onclick="closeScheduleModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="scheduleForm">
                    <div class="form-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="candidateName">Candidate Name</label>
                            <input type="text" id="candidateName" name="candidateName" required>
                        </div>
                        <div class="form-group">
                            <label for="candidateEmail">Candidate Email</label>
                            <input type="email" id="candidateEmail" name="candidateEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="interviewDate">Interview Date</label>
                            <input type="date" id="interviewDate" name="interviewDate" required>
                        </div>
                        <div class="form-group">
                            <label for="interviewTime">Interview Time</label>
                            <input type="time" id="interviewTime" name="interviewTime" required>
                        </div>
                        <div class="form-group">
                            <label for="interviewType">Interview Type</label>
                            <select id="interviewType" name="interviewType" required>
                                <option value="">Select Type</option>
                                <option value="Phone">Phone Interview</option>
                                <option value="Video">Video Interview</option>
                                <option value="In-person">In-person Interview</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="interviewer">Interviewer</label>
                            <input type="text" id="interviewer" name="interviewer" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="interviewNotes">Notes</label>
                        <textarea id="interviewNotes" name="interviewNotes" rows="3" placeholder="Any special instructions or notes..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeScheduleModal()">Cancel</button>
                <button type="submit" form="scheduleForm" class="btn btn-success">Schedule Interview</button>
            </div>
        </div>
    </div>

    <script>
        // Authentication check - must be at the top
        document.addEventListener('DOMContentLoaded', function() {
            const token = localStorage.getItem('nexstaff_auth_token');
            const user = localStorage.getItem('nexstaff_user');
            
            if (!token || !user) {
                console.log('No authentication found, redirecting to login...');
                window.location.href = '../login.html';
                return;
            }
            
            try {
                const userData = JSON.parse(user);
                console.log('User authenticated:', userData.email);
                
                // Update user info in header
                const userNameEl = document.querySelector('.user-name');
                const userRoleEl = document.querySelector('.user-role');
                const userAvatarEl = document.querySelector('.user-avatar');
                  if (userNameEl) userNameEl.textContent = userData.name || 'Admin User';
                if (userRoleEl) userRoleEl.textContent = userData.role === 'admin' ? 'Administrator' : userData.role;
                if (userAvatarEl) userAvatarEl.textContent = (userData.name || 'Admin').charAt(0).toUpperCase();
                
                // Initialize sample data for testing
                if (typeof DataService !== 'undefined' && DataService.initializeSampleEmployers) {
                    DataService.initializeSampleEmployers();
                }
                
            } catch (e) {
                console.error('Invalid user data, redirecting to login...');
                localStorage.removeItem('nexstaff_auth_token');
                localStorage.removeItem('nexstaff_user');
                window.location.href = '../login.html';
            }
        });
    </script>    <script>
        // Dashboard Analytics and User Management
        const dashboardAnalytics = {
            loadUserProfile() {
                const userData = this.getUserFromStorage();
                if (userData) {
                    const userName = document.querySelector('.user-name');
                    const userRole = document.querySelector('.user-role');
                    const userAvatar = document.querySelector('.user-avatar');
                    
                    if (userName) userName.textContent = userData.name || 'Admin User';
                    if (userRole) userRole.textContent = userData.role || 'Administrator';
                    if (userAvatar) userAvatar.textContent = userData.name ? userData.name.charAt(0).toUpperCase() : 'A';
                }
            },
            
            getUserFromStorage() {
                try {
                    const userStr = localStorage.getItem('nexstaff_user');
                    return userStr ? JSON.parse(userStr) : null;
                } catch (error) {
                    console.error('Error loading user data:', error);
                    return null;
                }
            }
        };

        // Sample data and helper functions
        const sampleEmployees = [
            {
                id: 'EMP001',
                name: 'John Smith',
                email: 'john.smith@nexstaff.com',
                department: 'Technology',
                position: 'Software Engineer',
                hireDate: '2024-01-15',
                status: 'Active'
            },
            {
                id: 'EMP002',
                name: 'Sarah Johnson',
                email: 'sarah.johnson@nexstaff.com',
                department: 'Marketing',
                position: 'Marketing Manager',
                hireDate: '2024-02-20',
                status: 'Active'
            }        ];

        // Initialize CRUD Management System
        class CRUDManager {
            constructor() {
                this.dataService = window.DataService || DataService;
                this.currentEntity = null;
                this.currentEntityType = null;
                this.initializeEventListeners();
                this.loadAllData();
            }            initializeEventListeners() {
                // Remove existing listeners to prevent duplicates
                const removeOldListeners = (id, eventType) => {
                    const element = document.getElementById(id);
                    if (element) {
                        const newElement = element.cloneNode(true);
                        element.parentNode.replaceChild(newElement, element);
                        return newElement;
                    }
                    return null;
                };
                
                // Add button listeners with clean elements
                const elementsToInitialize = [
                    { id: 'employeeSectionAddBtn', type: 'employee' },
                    { id: 'addCandidateBtn', type: 'candidate' },
                    { id: 'addEmployerBtn', type: 'employer' },
                    { id: 'addJobBtn', type: 'job' },
                    { id: 'addApplicationBtn', type: 'application' },
                    { id: 'addScheduleBtn', type: 'schedule' }
                ];
                
                elementsToInitialize.forEach(item => {
                    const element = document.getElementById(item.id);
                    if (element) {
                        element.onclick = () => this.openCreateModal(item.type);
                    }
                });

                // Modal listeners
                document.getElementById('saveEntity')?.addEventListener('click', () => this.saveEntity());
                document.getElementById('cancelEntity')?.addEventListener('click', () => this.closeModal());
                document.getElementById('confirmDelete')?.addEventListener('click', () => this.confirmDelete());
                document.getElementById('cancelDelete')?.addEventListener('click', () => this.closeDeleteModal());
            }            // Removed showSection method - handled by AdminDashboard

            loadAllData() {
                this.loadSectionData('employees');
                this.loadSectionData('candidates');
                this.loadSectionData('employers');
                this.loadSectionData('jobs');
                this.loadSectionData('applications');
                this.loadSectionData('schedule');
            }

            loadSectionData(section) {
                switch(section) {
                    case 'employees':
                        this.loadEmployees();
                        break;
                    case 'candidates':
                        this.loadCandidates();
                        break;
                    case 'employers':
                        this.loadEmployers();
                        break;
                    case 'jobs':
                        this.loadJobs();
                        break;
                    case 'applications':
                        this.loadApplications();
                        break;
                    case 'schedule':
                        this.loadSchedules();
                        break;
                }
            }

            loadEmployees() {
                const employees = this.dataService.readEmployees();
                const tbody = document.getElementById('employeesTableBody');
                if (!tbody) return;

                tbody.innerHTML = employees.map(emp => `
                    <tr>
                        <td>${emp.id || 'N/A'}</td>
                        <td>${emp.name || 'N/A'}</td>
                        <td>${emp.email || 'N/A'}</td>
                        <td>${emp.department || 'N/A'}</td>
                        <td>${emp.position || 'N/A'}</td>
                        <td>${emp.hireDate || 'N/A'}</td>
                        <td><span class="badge badge-${emp.status === 'Active' ? 'success' : 'warning'}">${emp.status || 'Active'}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="crudManager.viewEntity('employee', ${emp.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-primary" onclick="crudManager.editEntity('employee', ${emp.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="crudManager.deleteEntity('employee', ${emp.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }

            loadCandidates() {
                const candidates = this.dataService.readCandidates();
                const tbody = document.getElementById('candidatesTableBody');
                if (!tbody) return;

                tbody.innerHTML = candidates.map(candidate => `
                    <tr>
                        <td>${candidate.id || 'N/A'}</td>
                        <td>${candidate.name || 'N/A'}</td>
                        <td>${candidate.email || 'N/A'}</td>
                        <td>${candidate.phone || 'N/A'}</td>
                        <td>${candidate.skills || 'N/A'}</td>
                        <td>${candidate.experience || 'N/A'}</td>
                        <td><span class="badge badge-${candidate.status === 'Available' ? 'success' : 'warning'}">${candidate.status || 'Available'}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="crudManager.viewEntity('candidate', ${candidate.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-primary" onclick="crudManager.editEntity('candidate', ${candidate.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="crudManager.deleteEntity('candidate', ${candidate.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }            loadEmployers() {
                console.log('Loading employers and applications...');
                try {
                    if (!this.dataService) {
                        console.error('DataService not available for loading employers');
                        return;
                    }
                    
                    // Load existing approved employers
                    const employers = this.dataService.readEmployers();
                    console.log('Existing employers:', employers);
                    
                    // Load employer applications
                    const applications = this.dataService.getAll('employer_applications') || [];
                    console.log('Employer applications:', applications);
                    
                    // Combine employers and applications
                    const allData = [
                        ...employers,
                        ...applications.map(app => ({
                            ...app,
                            id: app.id,
                            company: app.companyName,
                            companyName: app.companyName,
                            contactPerson: app.contactPerson,
                            email: app.email,
                            phone: app.phone,
                            industry: app.industry,
                            status: app.status || 'Pending',
                            website: app.website,
                            address: app.address,
                            description: app.description,
                            companySize: app.companySize,
                            hiringNeeds: app.hiringNeeds,
                            applicationDate: app.applicationDate,
                            applicationType: 'employer_application'
                        }))
                    ];
                    
                    console.log('Combined employers and applications:', allData);
                    
                    // Store all data for filtering
                    this.allEmployers = allData;
                    this.displayEmployers(allData);
                    
                    // Update dashboard stats
                    this.updateEmployerStats(allData);
                    
                    // Add event listeners for filters
                    this.setupEmployerFilters();
                } catch (error) {
                    console.error('Error loading employers:', error);
                    const tbody = document.getElementById('employersTableBody');
                    if (tbody) {
                        tbody.innerHTML = '<tr><td colspan="8" class="text-center text-danger">Error loading employers</td></tr>';
                    }
                }
            }

            updateEmployerStats(employers) {
                // Update various stats displays
                const totalCount = employers.length;
                const activeCount = employers.filter(emp => emp.status === 'Active' || emp.status === 'Approved').length;
                const pendingCount = employers.filter(emp => emp.status === 'Pending').length;
                
                // Update any stat elements
                const employerCountEl = document.getElementById('employerCount');
                if (employerCountEl) {
                    employerCountEl.textContent = activeCount;
                }
                
                // Update dashboard cards if they exist
                const totalEmployersEl = document.getElementById('totalEmployers');
                if (totalEmployersEl) {
                    totalEmployersEl.textContent = totalCount;
                }
                
                const pendingEmployersEl = document.getElementById('pendingEmployers');
                if (pendingEmployersEl) {
                    pendingEmployersEl.textContent = pendingCount;
                }
            }

            displayEmployers(employers) {
                const tbody = document.getElementById('employersTableBody');
                if (!tbody) return;

                if (employers.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="8" class="text-center text-muted">No employers found</td></tr>';
                    return;
                }

                tbody.innerHTML = employers.map(employer => `
                    <tr>
                        <td>${employer.id || 'N/A'}</td>
                        <td>
                            <strong>${employer.company || 'N/A'}</strong>
                            ${employer.website ? `<br><small class="text-muted">${employer.website}</small>` : ''}
                        </td>
                        <td>${employer.contactPerson || 'N/A'}</td>
                        <td>
                            <a href="mailto:${employer.email}" class="text-primary">${employer.email || 'N/A'}</a>
                        </td>
                        <td>
                            ${employer.phone ? `<a href="tel:${employer.phone}" class="text-primary">${employer.phone}</a>` : 'N/A'}
                        </td>
                        <td>
                            ${employer.industry ? `<span class="badge badge-info">${employer.industry}</span>` : 'N/A'}
                        </td>
                        <td>
                            <span class="badge badge-${employer.status === 'Active' ? 'success' : (employer.status === 'Pending' ? 'warning' : employer.status === 'Rejected' ? 'danger' : 'secondary')}">${employer.status || 'Active'}</span>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-sm btn-outline" onclick="crudManager.viewEntity('employer', ${employer.id})" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                ${employer.status === 'Pending' ? `
                                    <button class="btn btn-sm btn-success" onclick="adminDashboard.approveEmployer(${employer.id})" title="Approve Employer">
                                        <i class="fas fa-check"></i>
                                    </button>
                                    <button class="btn btn-sm btn-warning" onclick="adminDashboard.rejectEmployer(${employer.id})" title="Reject Employer">
                                        <i class="fas fa-times"></i>
                                    </button>
                                ` : employer.status === 'Rejected' ? `
                                    <button class="btn btn-sm btn-success" onclick="adminDashboard.reactivateEmployer(${employer.id})" title="Reactivate Employer">
                                        <i class="fas fa-redo"></i>
                                    </button>
                                ` : ''}
                                <button class="btn btn-sm btn-primary" onclick="crudManager.editEntity('employer', ${employer.id})" title="Edit Employer">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="crudManager.deleteEntity('employer', ${employer.id})" title="Delete Employer">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `).join('');
            }

            setupEmployerFilters() {
                const searchInput = document.getElementById('employerSearch');
                const industryFilter = document.getElementById('industryFilter');
                const statusFilter = document.getElementById('statusFilter');

                if (!searchInput || !industryFilter || !statusFilter) return;

                const filterEmployers = () => {
                    const searchTerm = searchInput.value.toLowerCase();
                    const selectedIndustry = industryFilter.value;
                    const selectedStatus = statusFilter.value;

                    const filteredEmployers = this.allEmployers.filter(employer => {
                        const matchesSearch = !searchTerm || 
                            (employer.company && employer.company.toLowerCase().includes(searchTerm)) ||
                            (employer.contactPerson && employer.contactPerson.toLowerCase().includes(searchTerm)) ||
                            (employer.email && employer.email.toLowerCase().includes(searchTerm));

                        const matchesIndustry = !selectedIndustry || employer.industry === selectedIndustry;
                        const matchesStatus = !selectedStatus || employer.status === selectedStatus;

                        return matchesSearch && matchesIndustry && matchesStatus;
                    });

                    this.displayEmployers(filteredEmployers);
                };

                searchInput.addEventListener('input', filterEmployers);
                industryFilter.addEventListener('change', filterEmployers);
                statusFilter.addEventListener('change', filterEmployers);
            }loadJobs() {
                // Use JobManagementAPI if available, otherwise fallback to dataService
                if (window.JobManagementAPI) {
                    window.JobManagementAPI.loadJobs();
                    return;
                }
                
                const jobs = this.dataService.readJobs();
                const tbody = document.getElementById('jobsTableBody');
                if (!tbody) return;

                tbody.innerHTML = jobs.map(job => `
                    <tr>
                        <td>${job.id || 'N/A'}</td>
                        <td>${job.title || 'N/A'}</td>
                        <td>${job.company || 'N/A'}</td>
                        <td>${job.location || 'N/A'}</td>
                        <td>${job.type || 'N/A'}</td>
                        <td>${job.salary || 'N/A'}</td>
                        <td><span class="badge badge-${job.status === 'ACTIVE' ? 'success' : 'warning'}">${job.status || 'ACTIVE'}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="crudManager.viewEntity('job', ${job.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-primary" onclick="crudManager.editEntity('job', ${job.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="crudManager.deleteEntity('job', ${job.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }loadApplications() {
                const applications = this.dataService.readApplications();
                const tbody = document.getElementById('applicationsTableBody');
                if (!tbody) return;

                tbody.innerHTML = applications.map(app => {
                    const status = app.status || 'Pending';
                    const statusClass = status === 'Accepted' ? 'success' : 
                                      status === 'Pending' ? 'warning' : 
                                      status === 'Interview' ? 'info' :
                                      status === 'Under Review' ? 'primary' : 'danger';
                    
                    // Show accept/decline buttons only for pending applications
                    const hireBtns = (status === 'Pending' || status === 'Under Review' || status === 'Interview') ? `
                        <button class="btn btn-sm btn-success" onclick="crudManager.acceptApplication(${app.id})" title="Accept & Hire">
                            <i class="fas fa-check"></i> Accept
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="crudManager.declineApplication(${app.id})" title="Decline">
                            <i class="fas fa-times"></i> Decline
                        </button>
                    ` : '';

                    return `
                        <tr>
                            <td><input type="checkbox" value="${app.id}"></td>
                            <td>
                                <div class="candidate-info">
                                    <strong>${app.candidateName || app.name || 'N/A'}</strong>
                                    <br><small class="text-muted">${app.email || 'No email'}</small>
                                </div>
                            </td>
                            <td>${app.jobPosition || app.jobTitle || 'N/A'}</td>
                            <td><span class="status-badge status-${status.replace(' ', '-')}">${status}</span></td>
                            <td>${app.applicationDate || app.createdAt ? new Date(app.applicationDate || app.createdAt).toLocaleDateString() : 'N/A'}</td>
                            <td>${app.lastUpdated ? new Date(app.lastUpdated).toLocaleDateString() : 'N/A'}</td>
                            <td class="actions-cell">
                                <div class="action-buttons">
                                    ${hireBtns}
                                    <button class="btn btn-sm btn-outline" onclick="crudManager.viewEntity('application', ${app.id})" title="View Details">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-primary" onclick="crudManager.editEntity('application', ${app.id})" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-secondary" onclick="crudManager.deleteEntity('application', ${app.id})" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                }).join('');
            }

            loadSchedules() {
                const schedules = this.dataService.readSchedules();
                const tbody = document.getElementById('schedulesTableBody');
                if (!tbody) return;

                tbody.innerHTML = schedules.map(schedule => `
                    <tr>
                        <td>${schedule.id || 'N/A'}</td>
                        <td>${schedule.title || 'N/A'}</td>
                        <td>${schedule.date || 'N/A'}</td>
                        <td>${schedule.time || 'N/A'}</td>
                        <td>${schedule.type || 'N/A'}</td>
                        <td>${schedule.participants || 'N/A'}</td>
                        <td><span class="badge badge-${schedule.status === 'Scheduled' ? 'success' : 'warning'}">${schedule.status || 'Scheduled'}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="crudManager.viewEntity('schedule', ${schedule.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-primary" onclick="crudManager.editEntity('schedule', ${schedule.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="crudManager.deleteEntity('schedule', ${schedule.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }

            openCreateModal(entityType) {
                this.currentEntityType = entityType;
                this.currentEntity = null;
                this.populateModal(entityType, {});
                document.getElementById('entityModal').style.display = 'flex';
            }

            editEntity(entityType, id) {
                this.currentEntityType = entityType;
                let entity;
                
                switch(entityType) {
                    case 'employee':
                        entity = this.dataService.readEmployees().find(e => e.id == id);
                        break;
                    case 'candidate':
                        entity = this.dataService.readCandidates().find(e => e.id == id);
                        break;
                    case 'employer':
                        entity = this.dataService.readEmployers().find(e => e.id == id);
                        break;
                    case 'job':
                        entity = this.dataService.readJobs().find(e => e.id == id);
                        break;
                    case 'application':
                        entity = this.dataService.readApplications().find(e => e.id == id);
                        break;
                    case 'schedule':
                        entity = this.dataService.readSchedules().find(e => e.id == id);
                        break;
                }

                if (entity) {
                    this.currentEntity = entity;
                    this.populateModal(entityType, entity);
                    document.getElementById('entityModal').style.display = 'flex';
                }
            }

            viewEntity(entityType, id) {
                this.editEntity(entityType, id);
                // Make form read-only for view mode
                document.querySelectorAll('#entityModal input, #entityModal select, #entityModal textarea').forEach(input => {
                    input.disabled = true;
                });
                document.getElementById('saveEntity').style.display = 'none';
            }

            deleteEntity(entityType, id) {
                this.currentEntityType = entityType;
                this.currentEntity = { id };
                document.getElementById('deleteModal').style.display = 'flex';
            }

            populateModal(entityType, data) {
                const modal = document.getElementById('entityModal');
                const title = document.getElementById('modalTitle');
                const form = document.getElementById('entityForm');

                title.textContent = `${this.currentEntity ? 'Edit' : 'Add'} ${entityType.charAt(0).toUpperCase() + entityType.slice(1)}`;

                // Reset form
                form.innerHTML = '';

                // Generate form fields based on entity type
                const fields = this.getFormFields(entityType);
                form.innerHTML = fields.map(field => this.generateFormField(field, data[field.name] || '')).join('');
            }

            getFormFields(entityType) {
                const fieldConfigs = {
                    employee: [
                        { name: 'name', type: 'text', label: 'Full Name', required: true },
                        { name: 'email', type: 'email', label: 'Email', required: true },
                        { name: 'phone', type: 'tel', label: 'Phone' },
                        { name: 'department', type: 'text', label: 'Department', required: true },
                        { name: 'position', type: 'text', label: 'Position', required: true },
                        { name: 'hireDate', type: 'date', label: 'Hire Date' },
                        { name: 'salary', type: 'number', label: 'Salary' },
                        { name: 'status', type: 'select', label: 'Status', options: ['Active', 'Inactive', 'On Leave'] }
                    ],
                    candidate: [
                        { name: 'name', type: 'text', label: 'Full Name', required: true },
                        { name: 'email', type: 'email', label: 'Email', required: true },
                        { name: 'phone', type: 'tel', label: 'Phone' },
                        { name: 'skills', type: 'text', label: 'Skills' },
                        { name: 'experience', type: 'text', label: 'Experience' },
                        { name: 'education', type: 'text', label: 'Education' },
                        { name: 'status', type: 'select', label: 'Status', options: ['Available', 'Hired', 'Interviewing'] }
                    ],
                    employer: [
                        { name: 'company', type: 'text', label: 'Company Name', required: true },
                        { name: 'contactPerson', type: 'text', label: 'Contact Person', required: true },
                        { name: 'email', type: 'email', label: 'Email', required: true },
                        { name: 'phone', type: 'tel', label: 'Phone' },
                        { name: 'industry', type: 'text', label: 'Industry' },
                        { name: 'address', type: 'text', label: 'Address' },
                        { name: 'status', type: 'select', label: 'Status', options: ['Active', 'Inactive', 'Pending'] }
                    ],
                    job: [
                        { name: 'title', type: 'text', label: 'Job Title', required: true },
                        { name: 'company', type: 'text', label: 'Company', required: true },
                        { name: 'location', type: 'text', label: 'Location' },
                        { name: 'type', type: 'select', label: 'Job Type', options: ['Full-time', 'Part-time', 'Contract', 'Temporary', 'Internship'] },
                        { name: 'salary', type: 'text', label: 'Salary Range' },
                        { name: 'description', type: 'textarea', label: 'Description' },
                        { name: 'requirements', type: 'textarea', label: 'Requirements' },
                        { name: 'deadline', type: 'date', label: 'Application Deadline' },
                        { name: 'status', type: 'select', label: 'Status', options: ['Open', 'Closed', 'Draft'] }
                    ],                    application: [
                        { name: 'candidateName', type: 'text', label: 'Candidate Name', required: true },
                        { name: 'email', type: 'email', label: 'Email', required: true },
                        { name: 'phone', type: 'tel', label: 'Phone' },
                        { name: 'jobPosition', type: 'text', label: 'Job Position', required: true },
                        { name: 'applicationDate', type: 'date', label: 'Application Date' },
                        { name: 'status', type: 'select', label: 'Status', options: ['Pending', 'Under Review', 'Interview', 'Accepted', 'Rejected'] },
                        { name: 'notes', type: 'textarea', label: 'Notes' }
                    ],
                    schedule: [
                        { name: 'title', type: 'text', label: 'Event Title', required: true },
                        { name: 'date', type: 'date', label: 'Date', required: true },
                        { name: 'time', type: 'time', label: 'Time', required: true },
                        { name: 'type', type: 'select', label: 'Type', options: ['Interview', 'Meeting', 'Training', 'Other'] },
                        { name: 'participants', type: 'text', label: 'Participants' },
                        { name: 'location', type: 'text', label: 'Location' },
                        { name: 'description', type: 'textarea', label: 'Description' },
                        { name: 'status', type: 'select', label: 'Status', options: ['Scheduled', 'Completed', 'Cancelled'] }
                    ]
                };

                return fieldConfigs[entityType] || [];
            }

            generateFormField(field, value) {
                const { name, type, label, required, options } = field;
                
                if (type === 'select') {
                    return `
                        <div class="form-group">
                            <label for="${name}">${label}${required ? '*' : ''}</label>
                            <select id="${name}" name="${name}" class="form-control" ${required ? 'required' : ''}>
                                <option value="">Select ${label}</option>
                                ${options.map(opt => `<option value="${opt}" ${value === opt ? 'selected' : ''}>${opt}</option>`).join('')}
                            </select>
                        </div>
                    `;
                } else if (type === 'textarea') {
                    return `
                        <div class="form-group">
                            <label for="${name}">${label}${required ? '*' : ''}</label>
                            <textarea id="${name}" name="${name}" class="form-control" rows="4" ${required ? 'required' : ''}>${value}</textarea>
                        </div>
                    `;
                } else {
                    return `
                        <div class="form-group">
                            <label for="${name}">${label}${required ? '*' : ''}</label>
                            <input type="${type}" id="${name}" name="${name}" class="form-control" value="${value}" ${required ? 'required' : ''}>
                        </div>
                    `;
                }
            }

            saveEntity() {
                const form = document.getElementById('entityForm');
                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());

                if (this.currentEntity) {
                    // Update existing entity
                    data.id = this.currentEntity.id;
                    switch(this.currentEntityType) {
                        case 'employee':
                            this.dataService.updateEmployee(data);
                            break;
                        case 'candidate':
                            this.dataService.updateCandidate(data);
                            break;
                        case 'employer':
                            this.dataService.updateEmployer(data);
                            break;
                        case 'job':
                            this.dataService.updateJob(data);
                            break;
                        case 'application':
                            this.dataService.updateApplication(data);
                            break;
                        case 'schedule':
                            this.dataService.updateSchedule(data);
                            break;
                    }
                } else {
                    // Create new entity
                    switch(this.currentEntityType) {
                        case 'employee':
                            this.dataService.createEmployee(data);
                            break;
                        case 'candidate':
                            this.dataService.createCandidate(data);
                            break;
                        case 'employer':
                            this.dataService.createEmployer(data);
                            break;
                        case 'job':
                            this.dataService.createJob(data);
                            break;
                        case 'application':
                            this.dataService.createApplication(data);
                            break;
                        case 'schedule':
                            this.dataService.createSchedule(data);
                            break;
                    }
                }

                this.closeModal();
                this.loadSectionData(this.currentEntityType === 'schedule' ? 'schedule' : this.currentEntityType + 's');
            }

            confirmDelete() {
                const id = this.currentEntity.id;
                
                switch(this.currentEntityType) {
                    case 'employee':
                        this.dataService.deleteEmployee(id);
                        break;
                    case 'candidate':
                        this.dataService.deleteCandidate(id);
                        break;
                    case 'employer':
                        this.dataService.deleteEmployer(id);
                        break;
                    case 'job':
                        this.dataService.deleteJob(id);
                        break;
                    case 'application':
                        this.dataService.deleteApplication(id);
                        break;
                    case 'schedule':
                        this.dataService.deleteSchedule(id);
                        break;
                }

                this.closeDeleteModal();
                this.loadSectionData(this.currentEntityType === 'schedule' ? 'schedule' : this.currentEntityType + 's');
            }

            closeModal() {
                document.getElementById('entityModal').style.display = 'none';
                // Re-enable form fields
                document.querySelectorAll('#entityModal input, #entityModal select, #entityModal textarea').forEach(input => {
                    input.disabled = false;
                });
                document.getElementById('saveEntity').style.display = 'inline-block';
                
                // If this modal was opened from quick actions, restore the original section
                if (window.currentSectionBeforeAction) {
                    restoreSection();
                }
            }            closeDeleteModal() {
                document.getElementById('deleteModal').style.display = 'none';
            }            // Application Accept/Decline Methods
            acceptApplication(applicationId) {
                try {
                    const application = this.dataService.readApplications().find(app => app.id == applicationId);
                    if (!application) {
                        alert('Application not found!');
                        return;
                    }

                    // Show hire confirmation modal
                    const hireDetails = {
                        candidateName: application.candidateName || application.name,
                        jobTitle: application.jobPosition || application.jobTitle,
                        email: application.email
                    };

                    this.showHireModal(applicationId, hireDetails);
                } catch (error) {
                    console.error('Error in acceptApplication:', error);
                    alert('Error processing application. Please try again.');
                }
            }

            declineApplication(applicationId) {
                try {
                    const application = this.dataService.readApplications().find(app => app.id == applicationId);
                    if (!application) {
                        alert('Application not found!');
                        return;
                    }

                    const reason = prompt(`Decline application for ${application.candidateName || application.name}?\n\nPlease provide a reason (optional):`, 'Position filled / Not a good fit');
                    
                    if (reason !== null) { // User didn't cancel
                        const success = this.dataService.declineApplication(applicationId, reason);
                        if (success) {
                            alert('Application declined successfully!');
                            this.loadApplications();
                        } else {
                            alert('Error declining application. Please try again.');
                        }
                    }
                } catch (error) {
                    console.error('Error in declineApplication:', error);
                    alert('Error declining application. Please try again.');
                }
            }

            showHireModal(applicationId, hireDetails) {
                try {
                    // Remove any existing hire modal
                    const existingModal = document.querySelector('.hire-modal-overlay');
                    if (existingModal) {
                        existingModal.remove();
                    }                    // Create and show hire confirmation modal
                    const modal = document.createElement('div');
                    modal.className = 'hire-modal-overlay';
                    modal.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(15, 23, 42, 0.6);
                        backdrop-filter: blur(8px);
                        display: flex !important;
                        justify-content: center;
                        align-items: center;
                        z-index: 10000;
                    `;
                    
                    modal.innerHTML = `                        <div class="modal hire-modal" style="
                            background: rgba(255, 255, 255, 0.95);
                            backdrop-filter: blur(20px);
                            padding: 2rem;
                            border-radius: 24px;
                            width: 90%;
                            max-width: 600px;
                            max-height: 90vh;
                            overflow-y: auto;
                            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
                            border: 1px solid rgba(255, 255, 255, 0.3);
                            position: relative;
                            z-index: 10001;
                            display: block;
                        ">
                            <div class="modal-header" style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                margin-bottom: 2rem;
                                padding-bottom: 1rem;
                                border-bottom: 1px solid #F1F5F9;
                            ">
                                <h3 style="
                                    font-size: 1.75rem;
                                    font-weight: 700;
                                    color: #0F172A;
                                    margin: 0;
                                ">Accept Application & Hire Candidate</h3>
                                <button type="button" class="close-modal" style="
                                    background: rgba(100, 116, 139, 0.1);
                                    border: none;
                                    width: 44px;
                                    height: 44px;
                                    border-radius: 12px;
                                    cursor: pointer;
                                    color: #64748B;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 1.25rem;
                                " onclick="this.closest('.hire-modal-overlay').remove()"></button>
                            </div>
                            <div class="modal-body">
                                <div class="hire-info" style="
                                    background: rgba(139, 92, 246, 0.05);
                                    border: 1px solid rgba(139, 92, 246, 0.1);
                                    border-radius: 12px;
                                    padding: 1.5rem;
                                    margin-bottom: 2rem;
                                ">
                                    <h4 style="color: #8B5CF6; font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem;">
                                        Candidate: ${hireDetails.candidateName || 'N/A'}
                                    </h4>
                                    <p style="margin: 0.5rem 0; color: #64748B;">
                                        <strong style="color: #0F172A;">Position:</strong> ${hireDetails.jobTitle || 'N/A'}
                                    </p>
                                    <p style="margin: 0.5rem 0; color: #64748B;">
                                        <strong style="color: #0F172A;">Email:</strong> ${hireDetails.email || 'N/A'}
                                    </p>
                                </div>
                                <form id="hireForm">
                                    <div class="form-group" style="margin-bottom: 1.5rem;">
                                        <label for="hireDepartment" style="
                                            display: block;
                                            margin-bottom: 0.75rem;
                                            color: #0F172A;
                                            font-weight: 600;
                                            font-size: 0.875rem;
                                        ">Department</label>                                        <input type="text" id="hireDepartment" name="department" style="
                                            width: 100%;
                                            padding: 1rem 1.25rem;
                                            border: 2px solid #E2E8F0;
                                            border-radius: 12px;
                                            font-size: 1rem;
                                            color: #0F172A;
                                            background: #FFFFFF;
                                            box-sizing: border-box;
                                        " placeholder="e.g., Engineering, Sales, Marketing" required>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 1.5rem;">
                                        <label for="hireStartDate" style="
                                            display: block;
                                            margin-bottom: 0.75rem;
                                            color: #0F172A;
                                            font-weight: 600;
                                            font-size: 0.875rem;
                                        ">Start Date</label>                                        <input type="date" id="hireStartDate" name="startDate" style="
                                            width: 100%;
                                            padding: 1rem 1.25rem;
                                            border: 2px solid #E2E8F0;
                                            border-radius: 12px;
                                            font-size: 1rem;
                                            color: #0F172A;
                                            background: #FFFFFF;
                                            box-sizing: border-box;
                                        " required>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 1.5rem;">
                                        <label for="hireSalary" style="
                                            display: block;
                                            margin-bottom: 0.75rem;
                                            color: #0F172A;
                                            font-weight: 600;
                                            font-size: 0.875rem;
                                        ">Salary (optional)</label>                                        <input type="text" id="hireSalary" name="salary" style="
                                            width: 100%;
                                            padding: 1rem 1.25rem;
                                            border: 2px solid #E2E8F0;
                                            border-radius: 12px;
                                            font-size: 1rem;
                                            color: #0F172A;
                                            background: #FFFFFF;
                                            box-sizing: border-box;
                                        " placeholder="e.g., $60,000/year or TBD">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 1.5rem;">
                                        <label for="hireNotes" style="
                                            display: block;
                                            margin-bottom: 0.75rem;
                                            color: #0F172A;
                                            font-weight: 600;
                                            font-size: 0.875rem;
                                        ">Notes</label>                                        <textarea id="hireNotes" name="notes" style="
                                            width: 100%;
                                            padding: 1rem 1.25rem;
                                            border: 2px solid #E2E8F0;
                                            border-radius: 12px;
                                            font-size: 1rem;
                                            color: #0F172A;
                                            background: #FFFFFF;
                                            min-height: 120px;
                                            resize: vertical;
                                            box-sizing: border-box;
                                        " rows="3" placeholder="Any additional notes or comments..."></textarea>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 1.5rem;">
                                        <label style="
                                            display: flex;
                                            align-items: center;
                                            gap: 0.75rem;
                                            color: #0F172A;
                                            font-size: 0.875rem;
                                            font-weight: 500;
                                            cursor: pointer;
                                        ">
                                            <input type="checkbox" id="createEmployeeRecord" name="createEmployee" checked style="
                                                width: 18px;
                                                height: 18px;
                                                accent-color: #8B5CF6;
                                            ">
                                            Create employee record automatically
                                        </label>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer" style="
                                margin-top: 2.5rem;
                                display: flex;
                                justify-content: flex-end;
                                gap: 1rem;
                                padding-top: 1.5rem;
                                border-top: 1px solid #F1F5F9;
                            ">
                                <button type="button" class="btn btn-cancel" style="
                                    padding: 0.75rem 1.5rem;
                                    border: none;
                                    border-radius: 12px;
                                    cursor: pointer;
                                    font-weight: 600;
                                    font-size: 0.875rem;
                                    background: #E2E8F0;
                                    color: #64748B;
                                " onclick="this.closest('.hire-modal-overlay').remove()">Cancel</button>
                                <button type="button" class="btn btn-success" style="
                                    padding: 0.75rem 1.5rem;
                                    border: none;
                                    border-radius: 12px;
                                    cursor: pointer;
                                    font-weight: 600;
                                    font-size: 0.875rem;
                                    background: linear-gradient(135deg, #8B5CF6 0%, #3B82F6 50%, #06B6D4 100%);
                                    color: white;
                                " onclick="window.crudManager.confirmHire(${applicationId})">Accept & Hire</button>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(modal);
                    
                    // Set default start date to next Monday
                    const nextMonday = new Date();
                    nextMonday.setDate(nextMonday.getDate() + (1 + 7 - nextMonday.getDay()) % 7);
                    document.getElementById('hireStartDate').value = nextMonday.toISOString().split('T')[0];
                } catch (error) {
                    console.error('Error showing hire modal:', error);
                    alert('Error showing hire form. Please try again.');
                }
            }

            confirmHire(applicationId) {
                try {
                    const form = document.getElementById('hireForm');
                    if (!form) {
                        alert('Form not found. Please try again.');
                        return;
                    }

                    const formData = new FormData(form);
                    const hireDetails = Object.fromEntries(formData.entries());
                    hireDetails.createEmployee = document.getElementById('createEmployeeRecord').checked;
                    hireDetails.acceptedBy = 'Admin'; // You can customize this

                    const success = this.dataService.acceptApplication(applicationId, hireDetails);
                    
                    if (success) {
                        // Close modal
                        const modal = document.querySelector('.hire-modal-overlay');
                        if (modal) {
                            modal.remove();
                        }
                        
                        // Show success message
                        alert('Application accepted successfully! ' + 
                              (hireDetails.createEmployee ? 'Employee record has been created.' : ''));
                        
                        // Refresh applications table
                        this.loadApplications();
                        
                        // Refresh employees table if we created an employee record
                        if (hireDetails.createEmployee) {
                            this.loadEmployees();
                        }
                    } else {
                        alert('Error accepting application. Please try again.');
                    }                } catch (error) {
                    console.error('Error in confirmHire:', error);
                    alert('Error processing hire. Please try again.');
                }
            }

            // Employer approval methods
            approveEmployer(employerId) {
                try {
                    if (!confirm('Are you sure you want to approve this employer? They will be granted active status and full access to the platform.')) {
                        return;
                    }

                    // First check if it's an existing employer
                    let employer = this.dataService.getById('employers', employerId);
                    let isApplication = false;
                    
                    // If not found in employers, check employer_applications
                    if (!employer) {
                        employer = this.dataService.getById('employer_applications', employerId);
                        isApplication = true;
                    }
                    
                    if (!employer) {
                        this.showNotification('Employer not found.', 'error');
                        return;
                    }

                    const approvedEmployer = {
                        ...employer,
                        id: employer.id,
                        company: employer.companyName || employer.company,
                        companyName: employer.companyName || employer.company,
                        status: 'Active',
                        approvedAt: new Date().toISOString(),
                        approvedBy: 'Admin',
                        notes: (employer.notes || '') + `\nApproved on ${new Date().toLocaleString()}`
                    };
                    
                    if (isApplication) {
                        // Remove from applications and add to employers
                        this.dataService.delete('employer_applications', employerId);
                        this.dataService.create('employers', approvedEmployer);
                    } else {
                        // Update existing employer
                        this.dataService.update('employers', employerId, approvedEmployer);
                    }
                    
                    this.loadEmployers(); // Refresh the table
                    
                    // Sync with employers page
                    this.syncWithEmployersPage();
                    
                    // Send notification to employer (in real app)
                    this.notifyEmployerApproval(employer);
                    
                    this.showNotification(`Employer "${employer.companyName || employer.company}" has been approved successfully!`, 'success');
                    
                    // Log the action
                    console.log('Employer approved:', {
                        id: employerId,
                        company: employer.companyName || employer.company,
                        approvedAt: approvedEmployer.approvedAt,
                        wasApplication: isApplication
                    });
                      } catch (error) {
                    console.error('Error approving employer:', error);
                    this.showNotification('Error approving employer. Please try again.', 'error');
                }
            }

            notifyEmployerApproval(employer) {
                // In a real application, this would send an email notification
                console.log(`Notification: Employer ${employer.companyName || employer.company} has been approved`);
                
                // Create a mock notification for demo purposes
                const notification = {
                    to: employer.email,
                    subject: 'Welcome to NexStaff - Your Application Has Been Approved!',
                    message: `Congratulations! Your company "${employer.companyName || employer.company}" has been approved to join the NexStaff platform. You now have access to our pool of qualified candidates.`
                };
                
                // Store notification history (for demo)
                const notifications = JSON.parse(localStorage.getItem('employer_notifications') || '[]');
                notifications.push({
                    ...notification,
                    sentAt: new Date().toISOString(),
                    type: 'approval'                });                localStorage.setItem('employer_notifications', JSON.stringify(notifications));
            }

            rejectEmployer(employerId) {
                try {
                    const reason = prompt('Please provide a reason for rejecting this employer (optional):');
                    if (reason === null) return; // User cancelled
                    
                    if (!confirm('Are you sure you want to reject this employer? This will deny them access to the platform.')) {
                        return;
                    }

                    // First check if it's an existing employer
                    let employer = this.dataService.getById('employers', employerId);
                    let isApplication = false;
                    
                    // If not found in employers, check employer_applications
                    if (!employer) {
                        employer = this.dataService.getById('employer_applications', employerId);
                        isApplication = true;
                    }
                    
                    if (!employer) {
                        this.showNotification('Employer not found.', 'error');
                        return;
                    }

                    const rejectedEmployer = {
                        ...employer,
                        status: 'Rejected',
                        rejectedAt: new Date().toISOString(),
                        rejectedBy: 'Admin',
                        rejectionReason: reason || 'No reason provided',
                        notes: (employer.notes || '') + `\nRejected on ${new Date().toLocaleString()}. Reason: ${reason || 'No reason provided'}`
                    };
                    
                    if (isApplication) {
                        // Update the application status to rejected
                        this.dataService.update('employer_applications', employerId, rejectedEmployer);
                    } else {
                        // Update existing employer
                        this.dataService.update('employers', employerId, rejectedEmployer);
                    }
                    
                    this.loadEmployers(); // Refresh the table
                    
                    this.showNotification(`Employer "${employer.companyName || employer.company}" has been rejected.`, 'warning');
                    
                    // Log the action
                    console.log('Employer rejected:', {
                        id: employerId,
                        company: employer.companyName || employer.company,
                        rejectedAt: rejectedEmployer.rejectedAt,
                        reason: reason,
                        wasApplication: isApplication
                    });
                    
                } catch (error) {
                    console.error('Error rejecting employer:', error);
                    this.showNotification('Error rejecting employer. Please try again.', 'error');
                }
            }

            // New method to reactivate rejected employers
            reactivateEmployer(employerId) {
                try {
                    if (!confirm('Are you sure you want to reactivate this employer? They will be granted active status again.')) {
                        return;
                    }

                    const employer = this.dataService.getById('employers', employerId);
                    if (!employer) {
                        this.showNotification('Employer not found.', 'error');
                        return;
                    }

                    const updatedEmployer = {
                        ...employer,
                        status: 'Active',
                        reactivatedAt: new Date().toISOString(),
                        reactivatedBy: 'Admin',
                        notes: (employer.notes || '') + `\nReactivated on ${new Date().toLocaleString()}`
                    };
                    
                    this.dataService.updateEmployer(updatedEmployer);
                    this.loadEmployers(); // Refresh the table
                    
                    // Also update the employers.html page data
                    this.syncWithEmployersPage();
                    
                    this.showNotification(`Employer "${employer.company}" has been reactivated successfully!`, 'success');
                    
                    // Log the action
                    console.log('Employer reactivated:', {
                        id: employerId,
                        company: employer.company,
                        reactivatedAt: updatedEmployer.reactivatedAt
                    });
                    
                } catch (error) {
                    console.error('Error reactivating employer:', error);
                    this.showNotification('Error reactivating employer. Please try again.', 'error');
                }
            }

            // Enhanced notification system
            showNotification(message, type = 'info') {
                // Remove any existing notifications
                const existingNotifications = document.querySelectorAll('.admin-notification');
                existingNotifications.forEach(notification => notification.remove());

                // Create notification element
                const notification = document.createElement('div');
                notification.className = `admin-notification alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show`;
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    z-index: 9999;
                    min-width: 300px;
                    max-width: 500px;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                `;
                
                notification.innerHTML = `
                    <div class="d-flex align-items-center">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'} mr-2"></i>
                        <span>${message}</span>
                        <button type="button" class="close ml-auto" data-dismiss="alert">
                            <span>&times;</span>
                        </button>
                    </div>
                `;

                document.body.appendChild(notification);

                // Auto-remove after 5 seconds
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            }

            // Sync employer data with the employers.html page
            syncWithEmployersPage() {
                try {
                    // Dispatch a custom event that the employers.html page can listen to
                    document.dispatchEvent(new CustomEvent('employersUpdated', {
                        detail: {
                            timestamp: new Date().toISOString(),
                            source: 'admin-dashboard'
                        }
                    }));
                } catch (error) {
                    console.error('Error syncing with employers page:', error);
                }            }

        }
        
        // Initialize Dashboard Systems
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Initializing NexStaff Admin Dashboard...');
            
            // Initialize DataService
            if (typeof DataService !== 'undefined') {
                window.DataService = DataService;
                DataService.initializeSampleData();
                DataService.initSync();
                console.log('DataService initialized');
            }
            
            // Load user profile
            dashboardAnalytics.loadUserProfile();
            
            // Initialize navigation immediately
            initializeNavigation();
              // Initialize CRUD Manager
            const crudManager = new CRUDManager();
            window.crudManager = crudManager;
            window.adminDashboard = crudManager; // Alias for compatibility
            console.log('CRUDManager initialized');
              // Load initial data
            crudManager.loadAllData();
            
            // Initialize CandidateProfilesAPI
            if (typeof CandidateProfilesAPI !== 'undefined') {
                console.log('Initializing CandidateProfilesAPI...');
                // Don't auto-load, let it load when section is clicked
            }
            
            console.log('Initial data loaded');
        });
          // Simple, direct navigation system
        function initializeNavigation() {
            console.log(' Setting up navigation...');
            
            // Debug: Check elements before setup
            const navLinks = document.querySelectorAll('.nav-link[data-section]');
            console.log(` Found ${navLinks.length} navigation links:`);
            navLinks.forEach((link, index) => {
                console.log(`  ${index + 1}. ${link.dataset.section} - ${link.textContent.trim()}`);
            });
            
            // Navigation handler
            document.querySelectorAll('.nav-link[data-section]').forEach(link => {
                link.addEventListener('click', handleNavigation);
                console.log(` Added listener to: ${link.dataset.section}`);
            });
            
            // Logout handler
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', handleLogout);
                console.log(' Logout handler added');
            }
            
            // Mobile menu handlers
            const menuToggle = document.getElementById('menuToggle');
            const overlay = document.getElementById('overlay');
            
            if (menuToggle) {
                menuToggle.addEventListener('click', toggleMobileMenu);
                console.log(' Mobile menu toggle added');
            }
            
            if (overlay) {
                overlay.addEventListener('click', closeMobileMenu);
                console.log(' Mobile overlay handler added');
            }
            
            // Window resize handler
            window.addEventListener('resize', handleResize);
            
            console.log(' Navigation setup complete');
        }
          function handleNavigation(e) {
            e.preventDefault();
            const section = e.currentTarget.dataset.section;
            console.log(` Navigating to: ${section}`);
            
            // Debug: Check if elements exist
            const allNavLinks = document.querySelectorAll('.nav-link');
            const allSections = document.querySelectorAll('.section');
            console.log(` Found ${allNavLinks.length} nav links, ${allSections.length} sections`);
            
            // Update active navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            e.currentTarget.classList.add('active');
            console.log(` Updated navigation active state`);
            
            // Update content sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            const targetSection = document.getElementById(`${section}-section`);
            if (targetSection) {
                targetSection.classList.add('active');
                console.log(` Activated section: ${section}-section`);
                console.log(` Section classes:`, targetSection.className);
            } else {
                console.error(` Section not found: ${section}-section`);
            }
            
            // Update page title
            const titles = {
                dashboard: 'Dashboard',
                employees: 'Employees',
                candidates: 'Candidates',
                employers: 'Employers',
                schedule: 'Schedule',
                applications: 'Applications',
                jobs: 'Jobs',
                settings: 'Settings'
            };
            
            const pageTitle = document.getElementById('pageTitle');
            if (pageTitle) {
                pageTitle.textContent = titles[section] || 'Dashboard';
                console.log(` Updated page title to: ${titles[section]}`);
            }
              // Load section data
            if (window.crudManager) {
                console.log(` Loading data for section: ${section}`);
                window.crudManager.loadSectionData(section);
            } else {
                console.warn(` CRUDManager not available`);
            }            // Special handling for candidates section
            if (section === 'candidates') {
                console.log(` Handling candidates section...`);
                
                // Wait for API to be available
                const initCandidatesAPI = () => {
                    if (typeof CandidateProfilesAPI !== 'undefined') {
                        console.log(` CandidateProfilesAPI found, initializing...`);
                        CandidateProfilesAPI.init();
                        
                        // Test if API is working
                        console.log(' Testing API access...');
                        window.testCandidateAPI = function() {
                            console.log(' CandidateProfilesAPI available:', typeof CandidateProfilesAPI);
                            console.log(' createCandidate function:', typeof CandidateProfilesAPI.createCandidate);
                            return CandidateProfilesAPI;
                        };
                        console.log(' Run testCandidateAPI() in console to test');
                    } else {
                        console.warn(' CandidateProfilesAPI not yet available, retrying...');
                        setTimeout(initCandidatesAPI, 200);
                    }
                };
                
                setTimeout(initCandidatesAPI, 100);
            }
            
            // Close mobile menu if open
            closeMobileMenu();
        }
        
        function handleLogout(e) {
            e.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('nexstaff_user');
                localStorage.removeItem('nexstaff_auth_token');
                window.location.href = '../login.html';
            }
        }
        
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebar) sidebar.classList.toggle('open');
            if (overlay) overlay.classList.toggle('active');
        }
        
        function closeMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebar) sidebar.classList.remove('open');
            if (overlay) overlay.classList.remove('active');
        }
        
        function handleResize() {
            const isMobile = window.innerWidth <= 768;
            if (!isMobile) {
                closeMobileMenu();
            }
        }
    </script>
      <!-- Chart.js for dashboard analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    
    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Dashboard Custom Functions -->
    <script>
        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log(' Dashboard initializing...');
            
            try {
                // Show dashboard section by default
                showSection('dashboard');
                
                // Initialize section navigation
                initializeSectionNavigation();
                
                // Setup form handlers
                setupFormHandlers();
                
                // Initialize Chart (with a slight delay to ensure DOM is ready)
                setTimeout(() => {
                    initializeActivityChart();
                }, 100);
                
                // Initialize all modules
                if (typeof DashboardAnalytics !== 'undefined') {
                    console.log('Initializing DashboardAnalytics...');
                    DashboardAnalytics.init();
                } else {
                    console.warn('DashboardAnalytics not available');
                }
                
                if (typeof DashboardManager !== 'undefined') {
                    console.log('Initializing DashboardManager...');
                    DashboardManager.init();
                } else {
                    console.warn('DashboardManager not available');
                }
                
                console.log(' Dashboard initialized successfully');
            } catch (error) {
                console.error('Error initializing dashboard:', error);
            }
        });
        
        // Activity Chart Implementation
        // Handle quick action buttons to prevent double popups and stay on dashboard
        function handleQuickAction(section, action) {
            console.log(`Quick action: ${action} in section ${section}`);
            
            // Store the current section so we can return to it after modal operations
            window.currentSectionBeforeAction = getCurrentSection();
            
            // Perform the specific action without switching sections
            switch(action) {
                case 'addEmployee':
                    // Use the same modal as the employees tab
                    if (typeof crudManager !== 'undefined' && crudManager.openCreateModal) {
                        crudManager.openCreateModal('employee');
                    } else {
                        console.error('CRUD Manager not available');
                        alert('Employee management feature is not available');
                    }
                    break;
                case 'registerCandidate':
                    if (typeof CandidateProfilesAPI !== 'undefined' && CandidateProfilesAPI.createCandidate) {
                        CandidateProfilesAPI.createCandidate();
                    } else {
                        console.error('CandidateProfilesAPI not available');
                        alert('Candidate registration feature is not available');
                    }
                    break;
                case 'postJob':
                    // Use the CRUD manager for job posting too
                    if (typeof crudManager !== 'undefined' && crudManager.openCreateModal) {
                        crudManager.openCreateModal('job');
                    } else {
                        showAddJobModal();
                    }
                    break;
                case 'scheduleInterview':
                    // Use the CRUD manager for scheduling too
                    if (typeof crudManager !== 'undefined' && crudManager.openCreateModal) {
                        crudManager.openCreateModal('schedule');
                    } else {
                        showScheduleModal();
                    }
                    break;
                default:
                    console.error('Unknown action:', action);
            }
        }
        
        // Function to get current visible section
        function getCurrentSection() {
            const visibleSection = document.querySelector('.section[style*="display: block"]');
            if (visibleSection) {
                const id = visibleSection.id;
                return id.replace('-section', '');
            }
            return 'dashboard'; // Default to dashboard if no section is visible
        }
        
        function initializeActivityChart() {
            console.log('Initializing activity chart...');
            const canvas = document.getElementById('activityChart');
            if (!canvas) {
                console.warn('Activity chart canvas not found');
                return;
            }
            
            try {
                const ctx = canvas.getContext('2d');
                if (!ctx) {
                    console.warn('Could not get canvas context');
                    return;
                }
                
                console.log('Canvas context obtained, creating chart...');
                
                // Sample data for the activity chart
                const activityData = {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Employees Added',
                        data: [12, 19, 8, 15, 22, 18],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Candidates Registered',
                        data: [8, 12, 15, 20, 18, 25],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Jobs Posted',
                        data: [3, 5, 4, 7, 6, 8],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                };
                
                if (typeof Chart === 'undefined') {
                    console.error('Chart.js is not loaded');
                    
                    // Add fallback content if Chart.js fails to load
                    const container = canvas.parentElement;
                    container.innerHTML = `
                        <div style="height: 200px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;">
                            <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 1rem; color: #8B5CF6;"></i>
                            <p>Activity data visualization</p>
                            <p style="color: #64748B; font-size: 0.9rem;">Recent activities show increasing employee and candidate registrations</p>
                        </div>
                    `;
                    return;
                }
                
                // Create chart
                window.activityChart = new Chart(ctx, {
                    type: 'line',
                    data: activityData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: '#fff',
                                bodyColor: '#fff',
                                borderColor: '#8B5CF6',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)',
                                    borderColor: 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)',
                                    borderColor: 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        }
                    }
                });
                
                console.log('Activity chart created successfully');
            } catch (error) {
                console.error('Error creating chart:', error);
                
                // Add fallback content if chart creation fails
                const container = canvas.parentElement;
                container.innerHTML = `
                    <div style="height: 200px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;">
                        <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 1rem; color: #8B5CF6;"></i>
                        <p>Activity data visualization</p>
                        <p style="color: #64748B; font-size: 0.9rem;">Recent activities show increasing employee and candidate registrations</p>
                    </div>
                `;
            }
        }
        
        // Section Navigation Functions
        function initializeSectionNavigation() {
            const navLinks = document.querySelectorAll('.nav-link[data-section]');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.getAttribute('data-section');
                    showSection(section);
                    
                    // Update active nav link
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }
        
        function showSection(sectionName) {
            console.log(` Switching to section: ${sectionName}`);
            
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            
            // Show target section
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.style.display = 'block';
                console.log(` Section ${sectionName} displayed`);
                
                // Initialize section-specific functionality
                initializeSectionContent(sectionName);
            } else {
                console.warn(` Section ${sectionName} not found`);
            }
            
            // Update page title
            const titles = {
                dashboard: 'NexStaff Admin Dashboard',
                employees: 'Employee Management - NexStaff',
                candidates: 'Candidate Management - NexStaff',
                employers: 'Employer Management - NexStaff',
                jobs: 'Job Management - NexStaff',
                applications: 'Application Management - NexStaff',
                schedule: 'Schedule Management - NexStaff',
                settings: 'Settings - NexStaff'
            };
            
            if (titles[sectionName]) {
                document.title = titles[sectionName];
            }
        }
        
        function initializeSectionContent(sectionName) {
            switch(sectionName) {
                case 'candidates':
                    if (typeof CandidateProfilesAPI !== 'undefined') {
                        setTimeout(() => CandidateProfilesAPI.init(), 100);
                    }
                    break;
                case 'employees':
                    if (typeof EmployeeManagementAPI !== 'undefined') {
                        // Initialize employee management
                        console.log('Initializing employee management...');
                    }
                    break;
                default:
                    console.log(`No specific initialization for ${sectionName}`);
            }
        }
        
        // Quick Action Button Functions
        // Track modal state 
        window.modalState = {
            modalOpen: false
        };
        
        function showAddJobModal() {
            const modal = document.getElementById('postJobModal');
            if (modal) {
                // Store current section before showing modal
                if (!window.currentSectionBeforeAction) {
                    window.currentSectionBeforeAction = getCurrentSection();
                }
                modal.classList.add('active');
                // Reset form
                document.getElementById('postJobForm').reset();
            }
        }
        
        function closePostJobModal() {
            const modal = document.getElementById('postJobModal');
            if (modal) {
                modal.classList.remove('active');
                // Restore original section
                restoreSection();
            }
        }
        
        function showScheduleModal() {
            const modal = document.getElementById('scheduleModal');
            if (modal) {
                // Store current section before showing modal
                if (!window.currentSectionBeforeAction) {
                    window.currentSectionBeforeAction = getCurrentSection();
                }
                modal.classList.add('active');
                // Reset form
                document.getElementById('scheduleForm').reset();
                // Set minimum date to today
                const dateInput = document.getElementById('interviewDate');
                if (dateInput) {
                    dateInput.min = new Date().toISOString().split('T')[0];
                }
            }
        }
        
        function closeScheduleModal() {
            const modal = document.getElementById('scheduleModal');
            if (modal) {
                modal.classList.remove('active');
                // Restore original section
                restoreSection();
            }
        }
        
        // Helper function to restore the original section after modal closes
        function restoreSection() {
            if (window.currentSectionBeforeAction) {
                showSection(window.currentSectionBeforeAction);
                
                // Update active navigation link to match
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('data-section') === window.currentSectionBeforeAction) {
                        link.classList.add('active');
                    }
                });
                
                // Reset the stored section
                window.currentSectionBeforeAction = null;
            }
        }
        
        // Form submission handlers
        function setupFormHandlers() {
            console.log('Setting up form handlers...');
            
            // Add Employee Form Handler
            const addEmployeeForm = document.getElementById('addEmployeeForm');
            if (addEmployeeForm) {
                addEmployeeForm.onsubmit = function(e) {
                    e.preventDefault();
                    const formData = new FormData(this);
                    const employeeData = Object.fromEntries(formData);
                    
                    console.log('Adding new employee:', employeeData);
                    
                    // Here you would typically send the data to your backend
                    // For now, we'll just show a success message
                    alert('Employee added successfully!');
                    if (typeof crudManager !== 'undefined') {
                        crudManager.closeModal(); // Let CRUD manager handle closing
                    } else {
                        restoreSection(); // Directly restore section
                    }
                };
                console.log('Employee form handler attached');
            }
            
            // Post Job Form Handler
            const postJobForm = document.getElementById('postJobForm');
            if (postJobForm) {
                postJobForm.onsubmit = function(e) {
                    e.preventDefault();
                    const formData = new FormData(this);
                    const jobData = Object.fromEntries(formData);
                    
                    console.log('Posting new job:', jobData);
                    
                    // Here you would typically send the data to your backend
                    alert('Job posted successfully!');
                    closePostJobModal(); // This already restores the original section
                };
                console.log('Job form handler attached');
            }
            
            // Schedule Interview Form Handler
            const scheduleForm = document.getElementById('scheduleForm');
            if (scheduleForm) {
                scheduleForm.onsubmit = function(e) {
                    e.preventDefault();
                    const formData = new FormData(this);
                    const scheduleData = Object.fromEntries(formData);
                    
                    console.log('Scheduling interview:', scheduleData);
                    
                    // Here you would typically send the data to your backend
                    alert('Interview scheduled successfully!');
                    closeScheduleModal(); // This already restores the original section
                };
                console.log('Schedule form handler attached');
            }
            
            // Close modals when clicking outside
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.classList.remove('active');
                    
                    // Reset all modal states
                    if (window.modalState) {
                        window.modalState.employeeModalOpen = false;
                    }
                    
                    // Restore the original section
                    restoreSection();
                }
            });
            
            console.log('Form handlers setup complete');
        }
        
        // Navigation helper functions (from existing code)
        function handleLogout(e) {
            e.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('nexstaff_user');
                localStorage.removeItem('nexstaff_auth_token');
                window.location.href = '../login.html';
            }
        }
        
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebar) sidebar.classList.toggle('open');
            if (overlay) overlay.classList.toggle('active');
        }
        
        function closeMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebar) sidebar.classList.remove('open');
            if (overlay) overlay.classList.remove('active');
        }
        
        // Window resize handler
        window.addEventListener('resize', function() {
            const isMobile = window.innerWidth <= 768;
            if (!isMobile) {
                closeMobileMenu();
            }
        });
    </script>
    
    <!-- Dashboard Analytics and Management Scripts -->
    <script src="js/dashboardAnalytics.js"></script>
    <script src="js/dashboardManager.js"></script>
    <script src="js/employeeManagement.js"></script>
    <script src="js/jobManagement.js"></script>
    <script src="js/schedule.js"></script>
    
    <!-- Candidate Profiles Management -->
    <script src="js/candidateProfiles.js"></script>
</body>
</html>
